package com.tmax.openframe;

import com.tmax.openframe.file.*;
import com.tmax.openframe.runtime.context.OpenFrameContext;
import com.tmax.openframe.runtime.file.FileStatus;
import com.tmax.openframe.runtime.flow.ControlManager;
import com.tmax.openframe.variable.CodsVariableContainer;
import com.tmax.openframe.variable.group.CodsAccountRecord;
import com.tmax.openframe.variable.group.CodsCardRecord;
import com.tmax.openframe.variable.group.CodsCardXrefRecord;
import com.tmax.openframe.variable.group.CodsCustomerRecord;
import com.tmax.openframe.variable.group.CodsSecUserData;
import com.tmax.openframe.variable.group.CodsTranRecord;
import java.math.*;
import java.util.*;
import java.util.function.Consumer;
import lombok.*;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Primary;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

/** 
 * <p>This source code was generated by T-Up OpenFrame COBOL to Java migrator</p>
 * <p>  Generation date : 2024/03/20 15:15:17 KST</p>
 * <hr>
 * <p>Java class for defining logics of COBOL program</p>
 * <ul>
 * <li>The name of COBOL program: CODS.cbl</li>
 * <li>Variable container class: {@link CodsVariableContainer}</li>
 * <li>The list of files used in the program</li>
 * <ul>
 * <li>CARDFILE-FILE: FD class {@code ->} {@link CodsFdCardfileFile}, record class {@code -> } {@link CodsCardRecord}</li>
 * <li>TRANSACT-FILE: FD class {@code ->} {@link CodsFdTransactFile}, record class {@code -> } {@link CodsTranRecord}</li>
 * <li>XREF-FILE: FD class {@code ->} {@link CodsFdXrefFile}, record class {@code -> } {@link CodsCardXrefRecord}</li>
 * <li>ACCTFILE-FILE: FD class {@code ->} {@link CodsFdAcctfileFile}, record class {@code -> } {@link CodsAccountRecord}</li>
 * <li>CUSTFILE-FILE: FD class {@code ->} {@link CodsFdCustfileFile}, record class {@code -> } {@link CodsCustomerRecord}</li>
 * <li>USRSEC-FILE: FD class {@code ->} {@link CodsFdUsrsecFile}, record class {@code -> } {@link CodsSecUserData}</li>
 * </ul>
 * </ul>
 */
@Service
@RequiredArgsConstructor
@Transactional
@Primary
public class Cods {
    // *
    /** 
     * <p>Class that manages an execution flow of the program</p>
     */
    protected final ControlManager controlManager;
    Consumer<OpenFrameContext> unnamedSentence = this::unnamedSentence;
    /** 
     * <p>Execution flow of COBOL program that defined in the procedure division</p>
     */
    ArrayList<Consumer> methodList = new ArrayList<>();
    {
        methodList.add(unnamedSentence);
    }
    @Autowired
    private CodsFileOpCardfileFile fdCardfileFile;
    @Autowired
    private CodsFileOpTransactFile fdTransactFile;
    @Autowired
    private CodsFileOpXrefFile fdXrefFile;
    @Autowired
    private CodsFileOpAcctfileFile fdAcctfileFile;
    @Autowired
    private CodsFileOpCustfileFile fdCustfileFile;
    @Autowired
    private CodsFileOpUsrsecFile fdUsrsecFile;

    /** 
     * <p>Method for executing a program logic that defined in the procedure division</p>
     * @param generalContext context that is necessary for executing program
     * @return return value of program
     */
    public int run(Map<String, Object> generalContext) {
        OpenFrameContext context = new OpenFrameContext(generalContext,
                methodList);
        if (context.getProgramVariableContainer("Cods") == null) {
            CodsVariableContainer container = new CodsVariableContainer();
            context.setProgramVariableContainer("Cods", container);
        }
        controlManager.run(context);
        return context.getReturnValue();
    }

    // *****************************************************************

    void unnamedSentence(OpenFrameContext context) {
        // [T-Up#INFO][CODS.cbl:125] DISPLAY statement
        System.out.println("DUMMY PROGRAM FOR DEFINE FD LAYOUT");
    }
}
